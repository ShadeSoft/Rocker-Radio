<!doctype html>
<html>
<head>
	<meta charset="utf-8">
	<title>Rocker R치di칩</title>
	<script>
		document.addEventListener('DOMContentLoaded', () => {
			setInterval(() => loadSongData(), 10000);
			loadSongData();
		});

		let loadSongData = () => {
			let xhr = new XMLHttpRequest();

			xhr.onreadystatechange = function() {
				if(this.readyState === 4 && this.status === 200) {
					let data = this.responseText
						.match(new RegExp('<td>Currently playing:</td><td class="streamstats">([^<]+)</td>'))[1]
						.replace(/\s\[[0-9]{4}]/, '')
						.split(' - ');
					document.getElementById('song-title').innerHTML = data[1] ? data[1] : '';
					document.getElementById('song-artist').innerHTML = data[0] ? data[0] : '';
				}
			};

			xhr.open('GET', 'http://stream.diazol.hu:35200', true);
			xhr.send();
		};
	</script>
	<link href="https://fonts.googleapis.com/css?family=Open+Sans:300,600&display=swap" rel="stylesheet">
	<style rel="stylesheet">
		body {
			background: #111;
			color: #eee;
			margin: 0;
			padding: 0;
		}
		div {
			display: flex;
			align-items: center;
  			justify-content: center;
  			height: 100vh;
		}
		figure {
			text-align: center;
		}
		figure img {
			max-width: 250px;
			width: 50vw;
		}
		h1 {
			font-family: 'Open Sans', sans-serif;
			font-weight: 600;
		}
		h1 span {
			font-weight: 300;
		}
	</style>
</head>
<body>
	<div>
		<figure>
			<a href="http://rockerradio.online" target="_blank"><img src="icon.png" alt="Rocker R치di칩"></a>
			<h1><span id="song-title"></span><br><small id="song-artist"></small></h1>
			<audio controls autoplay src="http://stream.diazol.hu:35200/stream"></audio>
		</figure>
	</div>
</body>
</html>